/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{11:function(e,t,r){"use strict";r.d(t,"a",(function(){return E})),r.d(t,"b",(function(){return pt})),r.d(t,"c",(function(){return _t})),r.d(t,"d",(function(){return Tt})),r.d(t,"e",(function(){return mt})),r.d(t,"f",(function(){return H})),r.d(t,"g",(function(){return Ge})),r.d(t,"h",(function(){return $})),r.d(t,"i",(function(){return ne})),r.d(t,"j",(function(){return De})),r.d(t,"k",(function(){return Q})),r.d(t,"l",(function(){return j})),r.d(t,"m",(function(){return ht})),r.d(t,"n",(function(){return Be})),r.d(t,"o",(function(){return ke})),r.d(t,"p",(function(){return k})),r.d(t,"q",(function(){return Ve})),r.d(t,"r",(function(){return te})),r.d(t,"s",(function(){return lt})),r.d(t,"t",(function(){return ft})),r.d(t,"u",(function(){return ct}));var n=r(19),o=r(6),h=r(4),l=r(115),d=r(66),c=r(10);n.b.PREFER_ENV=h.n.any?o.f.WEBGL:o.f.WEBGL2,n.b.STRICT_TEXTURE_CACHE=!1;var f=[];function m(source,e){if(!source)return null;var t="";if("string"==typeof source){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(source);r&&(t=r[1].toLowerCase())}for(var i=f.length-1;i>=0;--i){var n=f[i];if(n.test&&n.test(source,t))return new n(source,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var v=function(e,b){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])})(e,b)};function y(e,b){function t(){this.constructor=e}v(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}var _=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new l.a("setRealSize"),this.onUpdate=new l.a("update"),this.onError=new l.a("onError")}return e.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},e.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},e.prototype.resize=function(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.destroyed||this.onUpdate.emit()},e.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.style=function(e,t,r){return!1},e.prototype.dispose=function(){},e.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},e.test=function(e,t){return!1},e}(),x=function(e){function t(source,t){var r=this,n=t||{},o=n.width,h=n.height;if(!o||!h)throw new Error("BufferResource width or height invalid");return(r=e.call(this,o,h)||this).data=source,r}return y(t,e),t.prototype.upload=function(e,t,r){var n=e.gl;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===o.a.UNPACK),r.width===t.width&&r.height===t.height?n.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,n.texImage2D(t.target,0,r.internalFormat,t.width,t.height,0,t.format,r.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(source){return source instanceof Float32Array||source instanceof Uint8Array||source instanceof Uint32Array},t}(_),T={scaleMode:o.n.NEAREST,format:o.g.RGBA,alphaMode:o.a.NPM},E=function(e){function t(t,r){void 0===t&&(t=null),void 0===r&&(r=null);var l=e.call(this)||this,d=(r=r||{}).alphaMode,c=r.mipmap,f=r.anisotropicLevel,v=r.scaleMode,y=r.width,x=r.height,T=r.wrapMode,E=r.format,w=r.type,S=r.target,A=r.resolution,C=r.resourceOptions;return!t||t instanceof _||((t=m(t,C)).internal=!0),l.width=y||0,l.height=x||0,l.resolution=A||n.b.RESOLUTION,l.mipmap=void 0!==c?c:n.b.MIPMAP_TEXTURES,l.anisotropicLevel=void 0!==f?f:n.b.ANISOTROPIC_LEVEL,l.wrapMode=T||n.b.WRAP_MODE,l.scaleMode=void 0!==v?v:n.b.SCALE_MODE,l.format=E||o.g.RGBA,l.type=w||o.p.UNSIGNED_BYTE,l.target=S||o.o.TEXTURE_2D,l.alphaMode=void 0!==d?d:o.a.UNPACK,void 0!==r.premultiplyAlpha&&(l.premultiplyAlpha=r.premultiplyAlpha),l.uid=Object(h.B)(),l.touched=0,l.isPowerOfTwo=!1,l._refreshPOT(),l._glTextures={},l.dirtyId=0,l.dirtyStyleId=0,l.cacheId=null,l.valid=y>0&&x>0,l.textureCacheIds=[],l.destroyed=!1,l.resource=null,l._batchEnabled=0,l._batchLocation=0,l.parentTextureArray=null,l.setResource(t),l}return y(t,e),Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,t){var r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=Object(h.o)(this.realWidth)&&Object(h.o)(this.realHeight)},t.prototype.setResolution=function(e){var t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT()),this},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete h.a[this.cacheId],delete h.e[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(source,e,r){void 0===r&&(r=n.b.STRICT_TEXTURE_CACHE);var o="string"==typeof source,l=null;o?l=source:(source._pixiId||(source._pixiId="pixiid_"+Object(h.B)()),l=source._pixiId);var d=h.a[l];if(o&&r&&!d)throw new Error('The cacheId "'+l+'" does not exist in BaseTextureCache.');return d||((d=new t(source,e)).cacheId=l,t.addToCache(d,l)),d},t.fromBuffer=function(e,r,n,h){e=e||new Float32Array(r*n*4);var l=new x(e,{width:r,height:n}),d=e instanceof Float32Array?o.p.FLOAT:o.p.UNSIGNED_BYTE;return new t(l,Object.assign(T,h||{width:r,height:n,type:d}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),h.a[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),h.a[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=h.a[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete h.a[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)delete h.a[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(h.c),w=function(e){function t(t,r){var n=this,o=r||{},h=o.width,l=o.height;(n=e.call(this,h,l)||this).items=[],n.itemDirtyIds=[];for(var i=0;i<t;i++){var d=new E;n.items.push(d),n.itemDirtyIds.push(-2)}return n.length=t,n._load=null,n.baseTexture=null,n}return y(t,e),t.prototype.initFromArray=function(e,t){for(var i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof _?this.addResourceAt(e[i],i):this.addResourceAt(m(e[i],t),i))},t.prototype.dispose=function(){for(var i=0,e=this.length;i<e;i++)this.items[i].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},t.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");e.prototype.bind.call(this,t);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=t,this.items[i].on("update",t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map((function(e){return e.resource})).filter((function(e){return e})).map((function(e){return e.load()}));return this._load=Promise.all(t).then((function(){var t=e.items[0],r=t.realWidth,n=t.realHeight;return e.resize(r,n),Promise.resolve(e)})),this._load},t}(_),S=function(e){function t(source,t){var r,n,o=this,h=t||{},l=h.width,d=h.height;return Array.isArray(source)?(r=source,n=source.length):n=source,o=e.call(this,n,{width:l,height:d})||this,r&&o.initFromArray(r,t),o}return y(t,e),t.prototype.addBaseTextureAt=function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this},t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=o.o.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,t,r){var n=this,o=n.length,h=n.itemDirtyIds,l=n.items,d=e.gl;r.dirtyId<0&&d.texImage3D(d.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,o,0,t.format,t.type,null);for(var i=0;i<o;i++){var c=l[i];h[i]<c.dirtyId&&(h[i]=c.dirtyId,c.valid&&d.texSubImage3D(d.TEXTURE_2D_ARRAY,0,0,0,i,c.resource.width,c.resource.height,1,t.format,t.type,c.resource.source))}return!0},t}(w),A=function(e){function t(source){var t=this,r=source,n=r.naturalWidth||r.videoWidth||r.width,o=r.naturalHeight||r.videoHeight||r.height;return(t=e.call(this,n,o)||this).source=source,t.noSubImage=!1,t}return y(t,e),t.crossOrigin=function(element,e,t){void 0===t&&0!==e.indexOf("data:")?element.crossOrigin=Object(h.i)(e):!1!==t&&(element.crossOrigin="string"==typeof t?t:"anonymous")},t.prototype.upload=function(e,t,r,source){var n=e.gl,h=t.realWidth,l=t.realHeight;return source=source||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===o.a.UNPACK),this.noSubImage||t.target!==n.TEXTURE_2D||r.width!==h||r.height!==l?(r.width=h,r.height=l,n.texImage2D(t.target,0,t.format,t.format,t.type,source)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.format,t.type,source),!0},t.prototype.update=function(){if(!this.destroyed){var source=this.source,t=source.naturalWidth||source.videoWidth||source.width,r=source.naturalHeight||source.videoHeight||source.height;this.resize(t,r),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(_),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.test=function(source){var e=window.OffscreenCanvas;return!!(e&&source instanceof e)||source instanceof HTMLCanvasElement},t}(A),I=function(e){function t(source,r){var n=this,h=r||{},l=h.width,d=h.height,c=h.autoLoad,f=h.linkBaseTexture;if(source&&source.length!==t.SIDES)throw new Error("Invalid length. Got "+source.length+", expected 6");n=e.call(this,6,{width:l,height:d})||this;for(var i=0;i<t.SIDES;i++)n.items[i].target=o.o.TEXTURE_CUBE_MAP_POSITIVE_X+i;return n.linkBaseTexture=!1!==f,source&&n.initFromArray(source,r),!1!==c&&n.load(),n}return y(t,e),t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=o.o.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error("Index "+t+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=o.o.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this},t.prototype.upload=function(e,r,n){for(var o=this.itemDirtyIds,i=0;i<t.SIDES;i++){var h=this.items[i];o[i]<h.dirtyId&&(h.valid&&h.resource?(h.resource.upload(e,h,n),o[i]=h.dirtyId):o[i]<-1&&(e.gl.texImage2D(h.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),o[i]=-1))}return!0},t.test=function(source){return Array.isArray(source)&&source.length===t.SIDES},t.SIDES=6,t}(w),R=function(e){function t(source,t){var r=this;if(t=t||{},!(source instanceof HTMLImageElement)){var o=new Image;A.crossOrigin(o,source,t.crossorigin),o.src=source,source=o}return r=e.call(this,source)||this,!source.complete&&r._width&&r._height&&(r._width=0,r._height=0),r.url=source.src,r._process=null,r.preserveBitmap=!1,r.createBitmap=(void 0!==t.createBitmap?t.createBitmap:n.b.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,r.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,void 0!==t.premultiplyAlpha&&(r.premultiplyAlpha=t.premultiplyAlpha),r.bitmap=null,r._load=null,!1!==t.autoLoad&&r.load(),r}return y(t,e),t.prototype.load=function(e){var t=this;return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((function(e,r){var source=t.source;t.url=source.src;var n=function(){t.destroyed||(source.onload=null,source.onerror=null,t.resize(source.width,source.height),t._load=null,t.createBitmap?e(t.process()):e(t))};source.complete&&source.src?n():(source.onload=n,source.onerror=function(e){r(e),t.onError.emit(e)})}))),this._load},t.prototype.process=function(){var e=this,source=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(source,0,0,source.width,source.height,{premultiplyAlpha:this.alphaMode===o.a.UNPACK?"premultiply":"none"}).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process):Promise.resolve(this)},t.prototype.upload=function(t,r,n){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,r,n,this.bitmap),!this.preserveBitmap){var o=!0,h=r._glTextures;for(var l in h){var d=h[l];if(d!==n&&d.dirtyId!==r.dirtyId){o=!1;break}}o&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(source){return"string"==typeof source||source instanceof HTMLImageElement},t}(A),O=function(e){function t(t,r){var n=this;return r=r||{},(n=e.call(this,document.createElement("canvas"))||this)._width=0,n._height=0,n.svg=t,n.scale=r.scale||1,n._overrideWidth=r.width,n._overrideHeight=r.height,n._resolve=null,n._crossorigin=r.crossorigin,n._load=null,!1!==r.autoLoad&&n.load(),n}return y(t,e),t.prototype.load=function(){var e=this;return this._load||(this._load=new Promise((function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}))),this._load},t.prototype._loadSvg=function(){var e=this,t=new Image;A.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(r){e._resolve&&(t.onerror=null,e.onError.emit(r))},t.onload=function(){if(e._resolve){var r=t.width,n=t.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var o=r*e.scale,l=n*e.scale;(e._overrideWidth||e._overrideHeight)&&(o=e._overrideWidth||e._overrideHeight/n*r,l=e._overrideHeight||e._overrideWidth/r*n),o=Math.round(o),l=Math.round(l);var canvas=e.source;canvas.width=o,canvas.height=l,canvas._pixiId="canvas_"+Object(h.B)(),canvas.getContext("2d").drawImage(t,0,0,r,n,0,0,o,l),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(source,e){return"svg"===e||"string"==typeof source&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(source)||"string"==typeof source&&0===source.indexOf("<svg")},t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(A),P=function(e){function t(source,r){var n=this;if(r=r||{},!(source instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof source&&(source=[source]);var h=source[0].src||source[0];A.crossOrigin(o,h,r.crossorigin);for(var i=0;i<source.length;++i){var l=document.createElement("source"),d=source[i],c=d.src,f=d.mime,m=(c=c||source[i]).split("?").shift().toLowerCase(),v=m.substr(m.lastIndexOf(".")+1);f=f||t.MIME_TYPES[v]||"video/"+v,l.src=c,l.type=f,o.appendChild(l)}source=o}return(n=e.call(this,source)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=r.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==r.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==r.autoLoad&&n.load(),n}return y(t,e),t.prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var r=d.a.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var source=this.source;return(source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height&&(source.complete=!0),source.addEventListener("play",this._onPlayStart.bind(this)),source.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(source.addEventListener("canplay",this._onCanPlay),source.addEventListener("canplaythrough",this._onCanPlay),source.addEventListener("error",this._onError,!0)),this._load=new Promise((function(t){e.valid?t(e):(e._resolve=t,source.load())})),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var source=this.source;return source.currentTime>0&&!1===source.paused&&!1===source.ended&&source.readyState>2},t.prototype._isSourceReady=function(){var source=this.source;return 3===source.readyState||4===source.readyState},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(d.a.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(d.a.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var source=this.source;source.removeEventListener("canplay",this._onCanPlay),source.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(source.videoWidth,source.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&source.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&d.a.shared.remove(this.update,this);var source=this.source;source&&(source.removeEventListener("error",this._onError,!0),source.pause(),source.src="",source.load()),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(d.a.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(d.a.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(source,e){return source instanceof HTMLVideoElement||t.TYPES.indexOf(e)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(A),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.test=function(source){return!!window.createImageBitmap&&source instanceof ImageBitmap},t}(A);f.push(R,F,C,P,O,x,I,S);var M=function(){function e(e){this.renderer=e}return e.prototype.destroy=function(){this.renderer=null},e}(),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),t.prototype.upload=function(e,t,r){var n=e.gl;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===o.a.UNPACK),r.width===t.width&&r.height===t.height?n.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,n.texImage2D(t.target,0,1===e.context.webGLVersion?n.DEPTH_COMPONENT:n.DEPTH_COMPONENT16,t.width,t.height,0,t.format,t.type,this.data)),!0},t}(x),U=function(){function e(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new l.a("disposeFramebuffer"),this.multisample=o.k.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,t){return void 0===e&&(e=0),this.colorTextures[e]=t||new E(null,{scaleMode:o.n.NEAREST,resolution:1,mipmap:o.j.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new E(new N(null,{width:this.width,height:this.height}),{scaleMode:o.n.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:o.j.OFF,format:o.g.DEPTH_COMPONENT,type:o.p.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(e/n,t/n)}if(this.depthTexture){n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,t/n)}}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),L=function(e){function t(t){var r=this;if("number"==typeof t){var n=arguments[0],o=arguments[1],h=arguments[2],l=arguments[3];t={width:n,height:o,scaleMode:h,resolution:l}}r=e.call(this,null,t)||this;var d=t||{},c=d.width,f=d.height;return r.mipmap=0,r.width=Math.ceil(c)||100,r.height=Math.ceil(f)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new U(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return y(t,e),t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(E),D=function(){function e(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return e.prototype.set=function(e,t,r){var n=t.width,th=t.height;if(r){var o=e.width/2/n,h2=e.height/2/th,h=e.x/n+o,l=e.y/th+h2;r=c.n.add(r,c.n.NW),this.x0=h+o*c.n.uX(r),this.y0=l+h2*c.n.uY(r),r=c.n.add(r,2),this.x1=h+o*c.n.uX(r),this.y1=l+h2*c.n.uY(r),r=c.n.add(r,2),this.x2=h+o*c.n.uX(r),this.y2=l+h2*c.n.uY(r),r=c.n.add(r,2),this.x3=h+o*c.n.uX(r),this.y3=l+h2*c.n.uY(r)}else this.x0=e.x/n,this.y0=e.y/th,this.x1=(e.x+e.width)/n,this.y1=e.y/th,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/th,this.x3=e.x/n,this.y3=(e.y+e.height)/th;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},e}(),B=new D,k=function(e){function t(r,n,o,h,l,d){var f=e.call(this)||this;if(f.noFrame=!1,n||(f.noFrame=!0,n=new c.j(0,0,1,1)),r instanceof t&&(r=r.baseTexture),f.baseTexture=r,f._frame=n,f.trim=h,f.valid=!1,f._uvs=B,f.uvMatrix=null,f.orig=o||n,f._rotate=Number(l||0),!0===l)f._rotate=2;else if(f._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return f.defaultAnchor=d?new c.g(d.x,d.y):new c.g(0,0),f._updateID=0,f.textureCacheIds=[],r.valid?f.noFrame?r.valid&&f.onBaseTextureUpdated(r):f.frame=n:r.once("loaded",f.onBaseTextureUpdated,f),f.noFrame&&r.on("update",f.onBaseTextureUpdated,f),f}return y(t,e),t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture;r&&r.url&&h.e[r.url]&&t.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},t.prototype.updateUvs=function(){this._uvs===B&&(this._uvs=new D),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(source,e,r){void 0===e&&(e={}),void 0===r&&(r=n.b.STRICT_TEXTURE_CACHE);var o="string"==typeof source,l=null;o?l=source:(source._pixiId||(source._pixiId="pixiid_"+Object(h.B)()),l=source._pixiId);var d=h.e[l];if(o&&r&&!d)throw new Error('The cacheId "'+l+'" does not exist in TextureCache.');return d||(e.resolution||(e.resolution=Object(h.k)(source)),(d=new t(new E(source,e))).baseTexture.cacheId=l,E.addToCache(d.baseTexture,l),t.addToCache(d,l)),d},t.fromURL=function(e,r){var n=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),o=t.from(e,Object.assign({resourceOptions:n},r),!1),h=o.baseTexture.resource;return o.baseTexture.valid?Promise.resolve(o):h.load().then((function(){return Promise.resolve(o)}))},t.fromBuffer=function(e,r,n,o){return new t(E.fromBuffer(e,r,n,o))},t.fromLoader=function(source,e,r){var o=new R(source);o.url=e;var l=new t(new E(o,{scaleMode:n.b.SCALE_MODE,resolution:Object(h.k)(e)}));return r||(r=e),E.addToCache(l.baseTexture,r),t.addToCache(l,r),r!==e&&(E.addToCache(l.baseTexture,e),t.addToCache(l,e)),l},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),h.e[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),h.e[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=h.e[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete h.e[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)h.e[e.textureCacheIds[i]]===e&&delete h.e[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,n=e.width,o=e.height,h=t+n>this.baseTexture.width,l=r+o>this.baseTexture.height;if(h||l){var d=h&&l?"and":"or",c="X: "+t+" + "+n+" = "+(t+n)+" > "+this.baseTexture.width,f="Y: "+r+" + "+o+" = "+(r+o)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+c+" "+d+" "+f)}this.valid=n&&o&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},t}(h.c);function G(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}k.EMPTY=new k(new E),G(k.EMPTY),G(k.EMPTY.baseTexture),k.WHITE=function(){var canvas=document.createElement("canvas");canvas.width=16,canvas.height=16;var e=canvas.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new k(new E(new C(canvas)))}(),G(k.WHITE),G(k.WHITE.baseTexture);var j=function(e){function t(t,r){var n=this,o=null;if(!(t instanceof L)){var h=arguments[1],l=arguments[2],d=arguments[3],c=arguments[4];console.warn("Please use RenderTexture.create("+h+", "+l+") instead of the ctor directly."),o=arguments[0],r=null,t=new L({width:h,height:l,scaleMode:d,resolution:c})}return(n=e.call(this,t,r)||this).legacyRenderer=o,n.valid=!0,n.filterFrame=null,n.filterPoolKey=null,n.updateUvs(),n}return y(t,e),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t,r){void 0===r&&(r=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){return"number"==typeof e&&(e={width:e,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new t(new L(e))},t}(k),V=function(){function e(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,t){var r=new L(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new j(r)},e.prototype.getOptimalTexture=function(t,r,n){void 0===n&&(n=1);var o=e.SCREEN_KEY;t*=n,r*=n,this.enableFullScreen&&t===this._pixelsWidth&&r===this._pixelsHeight||(o=(65535&(t=Object(h.r)(t)))<<16|65535&(r=Object(h.r)(r))),this.texturePool[o]||(this.texturePool[o]=[]);var l=this.texturePool[o].pop();return l||(l=this.createTexture(t,r)),l.filterPoolKey=o,l.setResolution(n),l},e.prototype.getFilterTexture=function(input,e){var t=this.getOptimalTexture(input.width,input.height,e||input.resolution);return t.filterFrame=input.filterFrame,t},e.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},e.prototype.returnFilterTexture=function(e){this.returnTexture(e)},e.prototype.clear=function(e){if(e=!1!==e)for(var i in this.texturePool){var t=this.texturePool[i];if(t)for(var r=0;r<t.length;r++)t[r].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var r=e.SCREEN_KEY,n=this.texturePool[r];if(this.enableFullScreen=t.width>0&&t.height>0,n)for(var o=0;o<n.length;o++)n[o].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY="screen",e}(),X=function(){function e(e,t,r,n,o,h,l){void 0===t&&(t=0),void 0===r&&(r=!1),void 0===n&&(n=5126),this.buffer=e,this.size=t,this.normalized=r,this.type=n,this.stride=o,this.start=h,this.instance=l}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,r,n,o,h){return new e(t,r,n,o,h)},e}(),z=0,H=function(){function e(data,e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),this.data=data||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=t,this.static=e,this.id=z++,this.disposeRunner=new l.a("disposeBuffer")}return e.prototype.update=function(data){this.data=data||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},e.from=function(data){return data instanceof Array&&(data=new Float32Array(data)),new e(data)},e}();function W(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var map={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var Y={5126:4,5123:2,5121:1},K=0,Z={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},$=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=K++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new l.a("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(e,t,r,n,o,h,l,d){if(void 0===r&&(r=0),void 0===n&&(n=!1),void 0===d&&(d=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof H||(t instanceof Array&&(t=new Float32Array(t)),t=new H(t));var c=e.split("|");if(c.length>1){for(var i=0;i<c.length;i++)this.addAttribute(c[i],t,r,n,o);return this}var f=this.buffers.indexOf(t);return-1===f&&(this.buffers.push(t),f=this.buffers.length-1),this.attributes[e]=new X(f,r,n,o,h,l,d),this.instanced=this.instanced||d,this},e.prototype.getAttribute=function(e){return this.attributes[e]},e.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},e.prototype.addIndex=function(e){return e instanceof H||(e instanceof Array&&(e=new Uint16Array(e)),e=new H(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var i,e=[],t=[],r=new H;for(i in this.attributes){var n=this.attributes[i],o=this.buffers[n.buffer];e.push(o.data),t.push(n.size*Y[n.type]/4),n.buffer=0}for(r.data=function(e,t){for(var r=0,n=0,o={},i=0;i<e.length;i++)n+=t[i],r+=e[i].length;var h=new ArrayBuffer(4*r),l=null,d=0;for(i=0;i<e.length;i++){var c=t[i],f=e[i],m=W(f);o[m]||(o[m]=new map[m](h)),l=o[m];for(var v=0;v<f.length;v++)l[(v/c|0)*n+d+v%c]=f[v];d+=c}return new Float32Array(h)}(e,t),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var i in this.attributes){var e=this.attributes[i];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var t=new e,i=0;i<this.buffers.length;i++)t.buffers[i]=new H(this.buffers[i].data.slice(0));for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new X(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},e.merge=function(t){for(var r,n=new e,o=[],h=[],l=[],i=0;i<t.length;i++){r=t[i];for(var d=0;d<r.buffers.length;d++)h[d]=h[d]||0,h[d]+=r.buffers[d].data.length,l[d]=0}for(i=0;i<r.buffers.length;i++)o[i]=new(Z[W(r.buffers[i].data)])(h[i]),n.buffers[i]=new H(o[i]);for(i=0;i<t.length;i++){r=t[i];for(d=0;d<r.buffers.length;d++)o[d].set(r.buffers[d].data,l[d]),l[d]+=r.buffers[d].data.length}if(n.attributes=r.attributes,r.indexBuffer){n.indexBuffer=n.buffers[r.buffers.indexOf(r.indexBuffer)],n.indexBuffer.index=!0;var c=0,f=0,m=0,v=0;for(i=0;i<r.buffers.length;i++)if(r.buffers[i]!==r.indexBuffer){v=i;break}for(var i in r.attributes){var y=r.attributes[i];(0|y.buffer)===v&&(f+=y.size*Y[y.type]/4)}for(i=0;i<t.length;i++){var _=t[i].indexBuffer.data;for(d=0;d<_.length;d++)n.indexBuffer.data[d+m]+=c;c+=r.buffers[v].data.length/f,m+=_.length}}return n},e}(),J=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return y(t,e),t}($),Q=function(e){function t(){var t=e.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new H(t.vertices),t.uvBuffer=new H(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return y(t,e),t.prototype.map=function(e,t){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+t.width/e.width,this.uvs[3]=n,this.uvs[4]=r+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=r,this.uvs[7]=n+t.height/e.height,r=t.x,n=t.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+t.width,this.vertices[3]=n,this.vertices[4]=r+t.width,this.vertices[5]=n+t.height,this.vertices[6]=r,this.vertices[7]=n+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}($),ee=0,te=function(){function e(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ee++,this.static=!!t}return e.prototype.update=function(){this.dirtyId++},e.prototype.add=function(t,r,n){this.uniforms[t]=new e(r,n)},e.from=function(t,r){return new e(t,r)},e}(),re=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new c.j,this.destinationFrame=new c.j,this.filters=[]}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}(),ie=function(e){function t(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new V,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new J,r.quadUv=new Q,r.tempRect=new c.j,r.activeState={},r.globalUniforms=new te({outputFrame:r.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return y(t,e),t.prototype.push=function(e,t){for(var r=this.renderer,n=this.defaultFilterStack,o=this.statePool.pop()||new re,h=t[0].resolution,l=t[0].padding,d=t[0].autoFit,c=t[0].legacy,i=1;i<t.length;i++){var filter=t[i];h=Math.min(h,filter.resolution),l=this.useMaxPadding?Math.max(l,filter.padding):l+filter.padding,d=d&&filter.autoFit,c=c||filter.legacy}1===n.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),n.push(o),o.resolution=h,o.legacy=c,o.target=e,o.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),o.sourceFrame.pad(l),d&&o.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),o.sourceFrame.ceil(h),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,h),o.filters=t,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var f=this.tempRect;f.width=o.sourceFrame.width,f.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,r.renderTexture.bind(o.renderTexture,o.sourceFrame,f),r.renderTexture.clear()},t.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;var n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;var h=n.inputSize,l=n.inputPixel,d=n.inputClamp;if(h[0]=t.destinationFrame.width,h[1]=t.destinationFrame.height,h[2]=1/h[0],h[3]=1/h[1],l[0]=h[0]*t.resolution,l[1]=h[1]*t.resolution,l[2]=1/l[0],l[3]=1/l[1],d[0]=.5*l[2],d[1]=.5*l[3],d[2]=t.sourceFrame.width*h[2]-.5*l[2],d[3]=t.sourceFrame.height*h[3]-.5*l[3],t.legacy){var c=n.filterArea;c[0]=t.destinationFrame.width,c[1]=t.destinationFrame.height,c[2]=t.sourceFrame.x,c[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();var f=e[e.length-1];if(t.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,f.renderTexture,o.d.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var m=t.renderTexture,v=this.getOptimalFilterTexture(m.width,m.height,t.resolution);v.filterFrame=m.filterFrame;var i=0;for(i=0;i<r.length-1;++i){r[i].apply(this,m,v,o.d.CLEAR,t);var y=m;m=v,v=y}r[i].apply(this,m,f.renderTexture,o.d.BLEND,t),this.returnFilterTexture(m),this.returnFilterTexture(v)}t.clear(),this.statePool.push(t)},t.prototype.bindAndClear=function(e,t){if(void 0===t&&(t=o.d.CLEAR),e&&e.filterFrame){var r=this.tempRect;r.width=e.filterFrame.width,r.height=e.filterFrame.height,this.renderer.renderTexture.bind(e,e.filterFrame,r)}else this.renderer.renderTexture.bind(e);"boolean"==typeof t&&(t=t?o.d.CLEAR:o.d.BLEND,Object(h.h)("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(t===o.d.CLEAR||t===o.d.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},t.prototype.applyFilter=function(filter,input,output,e){var t=this.renderer;this.bindAndClear(output,e),filter.uniforms.uSampler=input,filter.uniforms.filterGlobals=this.globalUniforms,t.state.set(filter.state),t.shader.bind(filter),filter.legacy?(this.quadUv.map(input._frame,input.filterFrame),t.geometry.bind(this.quadUv),t.geometry.draw(o.e.TRIANGLES)):(t.geometry.bind(this.quad),t.geometry.draw(o.e.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(e,t){var r=this.activeState,n=r.sourceFrame,o=r.destinationFrame,h=t._texture.orig,l=e.set(o.width,0,0,o.height,n.x,n.y),d=t.worldTransform.copyTo(c.d.TEMP_MATRIX);return d.invert(),l.prepend(d),l.scale(1/h.width,1/h.height),l.translate(t.anchor.x,t.anchor.y),l},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(e,t,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(e,t,r)},t.prototype.getFilterTexture=function(input,e){if("number"==typeof input){var t=input;input=e,e=t}input=input||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(input.width,input.height,e||input.resolution);return r.filterFrame=input.filterFrame,r},t.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t}(M),ne=function(){function e(e){this.renderer=e}return e.prototype.flush=function(){},e.prototype.destroy=function(){this.renderer=null},e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.render=function(e){},e}(),oe=function(e){function t(t){var r=e.call(this,t)||this;return r.emptyRenderer=new ne(t),r.currentRenderer=r.emptyRenderer,r}return y(t,e),t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var r=this.renderer.texture.boundTextures,i=t-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)},t.prototype.boundArray=function(e,t,r,n){for(var o=e.elements,h=e.ids,l=e.count,d=0,i=0;i<l;i++){var c=o[i],f=c._batchLocation;if(f>=0&&f<n&&t[f]===c)h[i]=f;else for(;d<n;){var m=t[d];if(!m||m._batchEnabled!==r||m._batchLocation!==d){h[i]=d,c._batchLocation=d,t[d]=c;break}d++}}},t}(M),se=0,ae=function(e){function t(t){var r=e.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return y(t,e),Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=se++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=se++,this.renderer.runners.contextChange.emit(e)},t.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},t.prototype.createContext=function(canvas,e){var t;if(n.b.PREFER_ENV>=o.f.WEBGL2&&(t=canvas.getContext("webgl2",e)),t)this.webGLVersion=2;else if(this.webGLVersion=1,!(t=canvas.getContext("webgl",e)||canvas.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=t,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var e=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:e.getExtension("EXT_color_buffer_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var view=this.renderer.view;view.removeEventListener("webglcontextlost",this.handleContextLost),view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in window&&e instanceof window.WebGL2RenderingContext;r&&(this.webGLVersion=2),t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var n=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(M),ue=function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=o.k.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},he=new c.j,le=function(e){function t(t){var r=e.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new U(10,10),r.msaaSamples=null,r}return y(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new c.j,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;n.b.PREFER_ENV===o.f.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},t.prototype.bind=function(e,t){var r=this.gl;if(e){var n=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.dirtyId!==e.dirtyId&&(n.dirtyId=e.dirtyId,n.dirtyFormat!==e.dirtyFormat?(n.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):n.dirtySize!==e.dirtySize&&(n.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var i=0;i<e.colorTextures.length;i++){var o=e.colorTextures[i];this.renderer.texture.unbind(o.parentTextureArray||o)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(e,t,r,n){var o=this.viewport;o.width===r&&o.height===n&&o.x===e&&o.y===t||(o.x=e,o.y=t,o.width=r,o.height=n,this.gl.viewport(e,t,r,n))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(e,g,b,a,mask){void 0===mask&&(mask=o.c.COLOR|o.c.DEPTH);var t=this.gl;t.clearColor(e,g,b,a),t.clear(mask)},t.prototype.initFramebuffer=function(e){var t=this.gl,r=new ue(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var n=e.colorTextures,i=0;i<n.length;i++)this.renderer.texture.bind(n[i],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},t.prototype.updateFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],n=e.colorTextures.length;t.drawBuffers||(n=Math.min(n,1)),r.multisample>1&&(r.msaaBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,t.RGBA8,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r.msaaBuffer));for(var o=[],i=0;i<n;i++)if(!(0===i&&r.multisample>1)){var h=e.colorTextures[i],l=h.parentTextureArray||h;this.renderer.texture.bind(l,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+i,h.target,l._glTextures[this.CONTEXT_UID].texture,0),o.push(t.COLOR_ATTACHMENT0+i)}if((o.length>1&&t.drawBuffers(o),e.depthTexture)&&this.writeDepthTexture){var d=e.depthTexture;this.renderer.texture.bind(d,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,d._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!e.stencil&&!e.depth||(r.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r.stencil))},t.prototype.detectSamples=function(e){var t=this.msaaSamples,r=o.k.NONE;if(e<=1||null===t)return r;for(var i=0;i<t.length;i++)if(t[i]<=e){r=t[i];break}return 1===r&&(r=o.k.NONE),r},t.prototype.blit=function(e,t,r){var n=this,o=n.current,h=n.renderer,l=n.gl,d=n.CONTEXT_UID;if(2===h.context.webGLVersion&&o){var c=o.glFramebuffers[d];if(c){if(!e){if(c.multisample<=1)return;c.blitFramebuffer||(c.blitFramebuffer=new U(o.width,o.height),c.blitFramebuffer.addColorTexture(0,o.colorTextures[0])),(e=c.blitFramebuffer).width=o.width,e.height=o.height}t||((t=he).width=o.width,t.height=o.height),r||(r=t);var f=t.width===r.width&&t.height===r.height;this.bind(e),l.bindFramebuffer(l.READ_FRAMEBUFFER,c.framebuffer),l.blitFramebuffer(t.x,t.y,t.width,t.height,r.x,r.y,r.width,r.height,l.COLOR_BUFFER_BIT,f?l.NEAREST:l.LINEAR)}}},t.prototype.disposeFramebuffer=function(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(r){delete e.glFramebuffers[this.CONTEXT_UID];var o=this.managedFramebuffers.indexOf(e);o>=0&&this.managedFramebuffers.splice(o,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(r.framebuffer),r.stencil&&n.deleteRenderbuffer(r.stencil))}},t.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<t.length;i++)this.disposeFramebuffer(t[i],e)},t.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var r=e.width,n=e.height,o=this.gl,h=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,h),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,r,n),t.stencil=h,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,h)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new c.j},t}(M),de=function(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},ce={5126:4,5123:2,5121:1},fe=function(e){function t(t){var r=e.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return y(t,e),t.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){var r=this.renderer.context.extensions.vertexArrayObject;n.b.PREFER_ENV===o.f.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=function(){return r.createVertexArrayOES()},e.bindVertexArray=function(e){return r.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return r.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==t.webGLVersion){var h=e.getExtension("ANGLE_instanced_arrays");h?(e.vertexAttribDivisor=function(a,b){return h.vertexAttribDivisorANGLE(a,b)},e.drawElementsInstanced=function(a,b,e,t,r){return h.drawElementsInstancedANGLE(a,b,e,t,r)},e.drawArraysInstanced=function(a,b,e,t){return h.drawArraysInstancedANGLE(a,b,e,t)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex},t.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var r=this.gl,n=e.glVertexArrayObjects[this.CONTEXT_UID],o=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},o=!0);var h=n[t.program.id]||this.initGeometryVao(e,t.program,o);this._activeGeometry=e,this._activeVao!==h&&(this._activeVao=h,this.hasVao?r.bindVertexArray(h):this.activateVao(e,t.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,i=0;i<e.buffers.length;i++){var r=e.buffers[i],n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var o=r.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(o,n.buffer),this._boundBuffer=n,n.byteLength>=r.data.byteLength)t.bufferSubData(o,0,r.data);else{var h=r.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,t.bufferData(o,r.data,h)}}}},t.prototype.checkCompatibility=function(e,t){var r=e.attributes,n=t.attributeData;for(var o in n)if(!r[o])throw new Error('shader and geometry incompatible, geometry missing the "'+o+'" attribute')},t.prototype.getSignature=function(e,t){var r=e.attributes,n=t.attributeData,o=["g",e.id];for(var i in r)n[i]&&o.push(i);return o.join("-")},t.prototype.initGeometryVao=function(e,t,r){void 0===r&&(r=!0),this.checkCompatibility(e,t);var n=this.gl,o=this.CONTEXT_UID,h=this.getSignature(e,t),l=e.glVertexArrayObjects[this.CONTEXT_UID],d=l[h];if(d)return l[t.id]=d,d;var c=e.buffers,f=e.attributes,m={},v={};for(var y in c)m[y]=0,v[y]=0;for(var y in f)!f[y].size&&t.attributeData[y]?f[y].size=t.attributeData[y].size:f[y].size||console.warn("PIXI Geometry attribute '"+y+"' size cannot be determined (likely the bound shader does not have the attribute)"),m[f[y].buffer]+=f[y].size*ce[f[y].type];for(var y in f){var _=f[y],x=_.size;void 0===_.stride&&(m[_.buffer]===x*ce[_.type]?_.stride=0:_.stride=m[_.buffer]),void 0===_.start&&(_.start=v[_.buffer],v[_.buffer]+=x*ce[_.type])}d=n.createVertexArray(),n.bindVertexArray(d);for(var i=0;i<c.length;i++){var T=c[i];T._glBuffers[o]||(T._glBuffers[o]=new de(n.createBuffer()),this.managedBuffers[T.id]=T,T.disposeRunner.add(this)),r&&T._glBuffers[o].refCount++}return this.activateVao(e,t),this._activeVao=d,l[t.id]=d,l[h]=d,d},t.prototype.disposeBuffer=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),r&&(t||n.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,o=e.buffers;if(e.disposeRunner.remove(this),r){for(var i=0;i<o.length;i++){var h=o[i]._glBuffers[this.CONTEXT_UID];h.refCount--,0!==h.refCount||t||this.disposeBuffer(o[i],t)}if(!t)for(var l in r)if("g"===l[0]){var d=r[l];this._activeVao===d&&this.unbind(),n.deleteVertexArray(d)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),i=0;i<t.length;i++)this.disposeGeometry(this.managedGeometries[t[i]],e);t=Object.keys(this.managedBuffers);for(i=0;i<t.length;i++)this.disposeBuffer(this.managedBuffers[t[i]],e)},t.prototype.activateVao=function(e,t){var r=this.gl,n=this.CONTEXT_UID,o=e.buffers,h=e.attributes;e.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[n].buffer);var l=null;for(var d in h){var c=h[d],f=o[c.buffer]._glBuffers[n];if(t.attributeData[d]){l!==f&&(r.bindBuffer(r.ARRAY_BUFFER,f.buffer),l=f);var m=t.attributeData[d].location;if(r.enableVertexAttribArray(m),r.vertexAttribPointer(m,c.size,c.type||r.FLOAT,c.normalized,c.stride,c.start),c.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(m,1)}}}},t.prototype.draw=function(e,t,r,n){var o=this.gl,h=this._activeGeometry;if(h.indexBuffer){var l=h.indexBuffer.data.BYTES_PER_ELEMENT,d=2===l?o.UNSIGNED_SHORT:o.UNSIGNED_INT;2===l||4===l&&this.canUseUInt32ElementIndex?h.instanced?o.drawElementsInstanced(e,t||h.indexBuffer.data.length,d,(r||0)*l,n||1):o.drawElements(e,t||h.indexBuffer.data.length,d,(r||0)*l):console.warn("unsupported index buffer type: uint32")}else h.instanced?o.drawArraysInstanced(e,r,t||h.getSize(),n||1):o.drawArrays(e,r,t||h.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(M),pe=function(){function e(e){void 0===e&&(e=null),this.type=o.i.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=o.i.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function me(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function ve(e,t,r,n){var o=me(e,e.VERTEX_SHADER,t),h=me(e,e.FRAGMENT_SHADER,r),l=e.createProgram();if(e.attachShader(l,o),e.attachShader(l,h),n)for(var i in n)e.bindAttribLocation(l,n[i],i);return e.linkProgram(l),e.getProgramParameter(l,e.LINK_STATUS)||(e.getShaderParameter(o,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(o))),e.getShaderParameter(h,e.COMPILE_STATUS)||(console.warn(r),console.error(e.getShaderInfoLog(h))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(l,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(l)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(l)),e.deleteProgram(l),l=null),e.deleteShader(o),e.deleteShader(h),l}function ge(e){for(var t=new Array(e),i=0;i<t.length;i++)t[i]=!1;return t}function ye(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return ge(2*t);case"bvec3":return ge(3*t);case"bvec4":return ge(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var _e,be={},xe=be;function Te(){if(xe===be||xe&&xe.isContextLost()){var canvas=document.createElement("canvas"),e=void 0;n.b.PREFER_ENV>=o.f.WEBGL2&&(e=canvas.getContext("webgl2",{})),e||((e=canvas.getContext("webgl",{})||canvas.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),xe=e}return xe}function Ee(e,t,r){if("precision"!==e.substring(0,9)){var n=t;return t===o.l.HIGH&&r!==o.l.HIGH&&(n=o.l.MEDIUM),"precision "+n+" float;\n"+e}return r!==o.l.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var we={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Se(e){return we[e]}var Ae=null,Ce={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Ie(e,t){if(!Ae){var r=Object.keys(Ce);Ae={};for(var i=0;i<r.length;++i){var n=r[i];Ae[e[n]]=Ce[n]}}return Ae[t]}var Re=[{test:function(data){return"float"===data.type&&1===data.size},code:function(e){return'\n            if(uv["'+e+'"] !== ud["'+e+'"].value)\n            {\n                ud["'+e+'"].value = uv["'+e+'"]\n                gl.uniform1f(ud["'+e+'"].location, uv["'+e+'"])\n            }\n            '}},{test:function(data){return("sampler2D"===data.type||"samplerCube"===data.type||"sampler2DArray"===data.type)&&1===data.size&&!data.isArray},code:function(e){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+e+'"], t);\n\n            if(ud["'+e+'"].value !== t)\n            {\n                ud["'+e+'"].value = t;\n                gl.uniform1i(ud["'+e+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(data,e){return"mat3"===data.type&&1===data.size&&void 0!==e.a},code:function(e){return'\n            gl.uniformMatrix3fv(ud["'+e+'"].location, false, uv["'+e+'"].toArray(true));\n            '}},{test:function(data,e){return"vec2"===data.type&&1===data.size&&void 0!==e.x},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+e+'"].location, v.x, v.y);\n                }'}},{test:function(data){return"vec2"===data.type&&1===data.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+e+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(data,e){return"vec4"===data.type&&1===data.size&&void 0!==e.width},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+e+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(data){return"vec4"===data.type&&1===data.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+e+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],Oe={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Pe={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Fe,Me=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ne(e){for(var t="",i=0;i<e;++i)i>0&&(t+="\nelse "),i<e-1&&(t+="if(test == "+i+".0){}");return t}var Ue=0,Le={},De=function(){function e(t,r,h){void 0===h&&(h="pixi-shader"),this.id=Ue++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(h=h.replace(/\s+/g,"-"),Le[h]?(Le[h]++,h+="-"+Le[h]):Le[h]=1,this.vertexSrc="#define SHADER_NAME "+h+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+h+"\n"+this.fragmentSrc,this.vertexSrc=Ee(this.vertexSrc,n.b.PRECISION_VERTEX,o.l.HIGH),this.fragmentSrc=Ee(this.fragmentSrc,n.b.PRECISION_FRAGMENT,function(){if(!_e){_e=o.l.MEDIUM;var e=Te();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);_e=t.precision?o.l.HIGH:o.l.MEDIUM}}return _e}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return e.prototype.extractData=function(e,t){var r=Te();if(r){var n=ve(r,e,t);this.attributeData=this.getAttributeData(n,r),this.uniformData=this.getUniformData(n,r),r.deleteProgram(n)}else this.uniformData={},this.attributeData={}},e.prototype.getAttributeData=function(e,t){for(var r={},n=[],o=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<o;i++){var h=t.getActiveAttrib(e,i),l=Ie(t,h.type),data={type:l,name:h.name,size:Se(l),location:0};r[h.name]=data,n.push(data)}n.sort((function(a,b){return a.name>b.name?1:-1}));for(i=0;i<n.length;i++)n[i].location=i;return r},e.prototype.getUniformData=function(e,t){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<n;i++){var o=t.getActiveUniform(e,i),h=o.name.replace(/\[.*?\]$/,""),l=o.name.match(/\[.*?\]$/),d=Ie(t,o.type);r[h]={type:d,size:o.size,isArray:l,value:ye(d,o.size)}}return r},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),e.from=function(t,r,n){var o=t+r,l=h.d[o];return l||(h.d[o]=l=new e(t,r,n)),l},e}(),Be=function(){function e(e,t){for(var i in this.program=e,this.uniformGroup=t?t instanceof te?t:new te(t):new te({}),e.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))}return e.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var i in t.uniforms){var r=t.uniforms[i];if(r.group&&this.checkUniformExists(e,r))return!0}return!1},e.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),e.from=function(t,r,n){return new e(De.from(t,r),n)},e}(),ke=function(){function e(){this.data=0,this.blendMode=o.b.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(e){!!(1&this.data)!==e&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(e){!!(2&this.data)!==e&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(e){!!(4&this.data)!==e&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(e){!!(8&this.data)!==e&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(e){!!(16&this.data)!==e&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==o.b.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),Ge=function(e){function t(r,o,h){var l=this,d=De.from(r||t.defaultVertexSrc,o||t.defaultFragmentSrc);return(l=e.call(this,d,h)||this).padding=0,l.resolution=n.b.FILTER_RESOLUTION,l.enabled=!0,l.autoFit=!0,l.legacy=!!l.program.attributeData.aTextureCoord,l.state=new ke,l}return y(t,e),t.prototype.apply=function(e,input,output,t,r){e.applyFilter(this,input,output,t)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),t}(Be),je=new c.d,Ve=function(){function e(e,t){this._texture=e,this.mapCoord=new c.d,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,i=0;i<e.length;i+=2){var n=e[i],o=e[i+1];t[i]=n*r.a+o*r.c+r.tx,t[i+1]=n*r.b+o*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=t.orig,o=t.trim;o&&(je.set(n.width/o.width,0,0,n.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(je));var h=t.baseTexture,l=this.uClampFrame,d=this.clampMargin/h.resolution,c=this.clampOffset;return l[0]=(t._frame.x+d+c)/h.width,l[1]=(t._frame.y+d+c)/h.height,l[2]=(t._frame.x+t._frame.width-d+c)/h.width,l[3]=(t._frame.y+t._frame.height-d+c)/h.height,this.uClampOffset[0]=c/h.realWidth,this.uClampOffset[1]=c/h.realHeight,this.isSimple=t._frame.width===h.width&&t._frame.height===h.height&&0===t.rotate,!0},e}(),Xe=function(e){function t(t){var r=this,n=new c.d;return r=e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n")||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=n,r}return y(t,e),t.prototype.apply=function(e,input,output,t){var r=this.maskSprite,n=r._texture;n.valid&&(n.uvMatrix||(n.uvMatrix=new Ve(n,0)),n.uvMatrix.update(),this.uniforms.npmAlpha=n.baseTexture.alphaMode?0:1,this.uniforms.mask=n,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,r).prepend(n.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=n.uvMatrix.uClampFrame,e.applyFilter(this,input,output,t))},t}(Ge),ze=function(e){function t(t){var r=e.call(this,t)||this;return r.enableScissor=!1,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return y(t,e),t.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},t.prototype.push=function(e,t){var r=t;if(!r.isMaskData){var n=this.maskDataPool.pop()||new pe;n.pooled=!0,n.maskObject=t,r=n}switch(r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=e,r.type){case o.i.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case o.i.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case o.i.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r)}},t.prototype.pop=function(e){var t=this.maskStack.pop();if(t&&t._target===e){switch(t.type){case o.i.SCISSOR:this.renderer.scissor.pop();break;case o.i.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case o.i.SPRITE:this.popSpriteMask()}t.reset(),t.pooled&&this.maskDataPool.push(t)}},t.prototype.detect=function(e){var t=e.maskObject;if(t.isSprite)e.type=o.i.SPRITE;else if(e.type=o.i.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var r=t.worldTransform,n=Math.atan2(r.b,r.a),h=Math.atan2(r.d,r.c);n=Math.round(n*(180/Math.PI)*100),h=((h=Math.round(h*(180/Math.PI)*100)-n)%18e3+18e3)%18e3,0===(n=(n%9e3+9e3)%9e3)&&9e3===h&&(e.type=o.i.SCISSOR)}},t.prototype.pushSpriteMask=function(e){var t=e.maskObject,r=e._target,n=this.alphaMaskPool[this.alphaMaskIndex];n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Xe(t)]),n[0].resolution=this.renderer.resolution,n[0].maskSprite=t;var o=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,n),r.filterArea=o,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(M),He=function(e){function t(t){var r=e.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return y(t,e),t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var n=this.getStackLength();n!==r&&(0===n?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.maskStack=null},t}(M),We=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return y(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var r=e._scissorRect,n=t.getBounds(!0),o=this.renderer.gl;t.renderable=!1,r?n.fit(r):o.enable(o.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=n,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var rect=this.maskStack[this.maskStack.length-1]._scissorRect,rt=this.renderer.renderTexture.current,e=this.renderer.projection,t=e.transform,r=e.sourceFrame,n=e.destinationFrame,o=rt?rt.resolution:this.renderer.resolution,h=(rect.x-r.x)*o+n.x,l=(rect.y-r.y)*o+n.y,d=rect.width*o,c=rect.height*o;t&&(h+=t.tx*o,l+=t.ty*o),rt||(l=this.renderer.height-c-l),this.renderer.gl.scissor(h,l,d,c)},t}(He),Ye=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return y(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,r=this.renderer.gl,n=e._stencilCounter;0===n&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),e._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,n,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(He),Ke=function(e){function t(t){var r=e.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new c.d,r.transform=null,r}return y(t,e),t.prototype.update=function(e,t,r,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,n),this.transform&&this.projectionMatrix.append(this.transform);var o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,r,n){var o=this.projectionMatrix,h=n?-1:1;o.identity(),o.a=1/t.width*2,o.d=h*(1/t.height*2),o.tx=-1-t.x*o.a,o.ty=-h-t.y*o.d},t.prototype.setTransform=function(e){},t}(M),qe=new c.j,Ze=new c.j,$e=new c.j,Je=function(e){function t(t){var r=e.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new c.j,r.destinationFrame=new c.j,r}return y(t,e),t.prototype.bind=function(e,t,r){void 0===e&&(e=null);var n,o,h,l=this.renderer;this.current=e,e?(h=(n=e.baseTexture).resolution,t||(qe.width=e.frame.width,qe.height=e.frame.height,t=qe),r||(Ze.x=e.frame.x,Ze.y=e.frame.y,Ze.width=t.width,Ze.height=t.height,r=Ze),o=n.framebuffer):(h=l.resolution,t||(qe.width=l.screen.width,qe.height=l.screen.height,t=qe),r||((r=qe).width=t.width,r.height=t.height)),$e.x=r.x*h,$e.y=r.y*h,$e.width=r.width*h,$e.height=r.height*h,this.renderer.framebuffer.bind(o,$e),this.renderer.projection.update(r,t,h,!o),e?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(e,mask){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor,this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],mask)},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(M),Qe=function(){function e(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return e.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},e}(),et=0,tt={textureCount:0},it=function(e){function t(t){var r=e.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=et++,r}return y(t,e),t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Fe)return Fe;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");Fe=!0===e({a:"b"},"a","b")}catch(e){Fe=!1}return Fe}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,n=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(n.program)),t||(tt.textureCount=0,this.syncUniformGroup(e.uniformGroup,tt)),n},t.prototype.setUniforms=function(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var r=this.getglProgram();e.static&&e.dirtyId===r.uniformGroups[e.id]||(r.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))},t.prototype.syncUniforms=function(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=function(e,t){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var i in e.uniforms){var data=t[i];if(data){for(var n=e.uniforms[i],o=!1,h=0;h<Re.length;h++)if(Re[h].test(data,n)){r.push(Re[h].code(i,n)),o=!0;break}if(!o){var template=(1===data.size?Oe:Pe)[data.type].replace("location",'ud["'+i+'"].location');r.push('\n            cv = ud["'+i+'"].value;\n            v = uv["'+i+'"];\n            '+template+";")}}else e.uniforms[i].group&&r.push('\n                    renderer.shader.syncUniformGroup(uv["'+i+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",r.join("\n"))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(e,t){var r=e.uniforms,n=[];for(var i in r)n.push(i),t[i]&&n.push(t[i].type);return n.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(e){var t=this.gl,r=e.program,n={};for(var i in r.attributeData)n[i]=r.attributeData[i].location;var o=ve(t,r.vertexSrc,r.fragmentSrc,n),h={};for(var i in r.uniformData){var data=r.uniformData[i];h[i]={location:t.getUniformLocation(o,i),value:ye(data.type,data.size)}}var l=new Qe(o,h);return r.glPrograms[this.renderer.CONTEXT_UID]=l,l},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(M);var nt=function(e){function t(t){var r=e.call(this,t)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=o.b.NONE,r._blendEq=!1,r.map=[],r.map[0]=r.setBlend,r.map[1]=r.setOffset,r.map[2]=r.setCullFace,r.map[3]=r.setDepthTest,r.map[4]=r.setFrontFace,r.checks=[],r.defaultState=new ke,r.defaultState.blend=!0,r}return y(t,e),t.prototype.contextChange=function(e){this.gl=e,this.blendModes=function(e,t){return void 0===t&&(t=[]),t[o.b.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.ADD]=[e.ONE,e.ONE],t[o.b.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.NONE]=[0,0],t[o.b.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[o.b.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[o.b.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[o.b.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[o.b.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[o.b.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[o.b.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[o.b.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[o.b.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[o.b.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[o.b.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()},t.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,i=0;t;)1&t&&this.map[i].call(this,!!(e.data&1<<i)),t>>=1,i++;this.stateId=e.data}for(i=0;i<this.checks.length;i++)this.checks[i](this,e)},t.prototype.forceState=function(e){e=e||this.defaultState;for(var i=0;i<this.map.length;i++)this.map[i].call(this,!!(e.data&1<<i));for(i=0;i<this.checks.length;i++)this.checks[i](this,e);this.stateId=e.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},t.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)},t.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},t.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},t}(M),ot=function(e){function t(t){var r=e.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=n.b.GC_MAX_IDLE,r.checkCountMax=n.b.GC_MAX_CHECK_COUNT,r.mode=n.b.GC_MODE,r}return y(t,e),t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==o.h.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,r=!1,i=0;i<t.length;i++){var n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){var o=0;for(i=0;i<t.length;i++)null!==t[i]&&(t[o++]=t[i]);t.length=o}},t.prototype.unload=function(e){var t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(var i=e.children.length-1;i>=0;i--)this.unload(e.children[i])},t}(M),st=function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},at=function(e){function t(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new E,r}return y(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var i=0;i<t;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new st(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new st(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(i=0;i<this.boundTextures.length;i++)this.bind(null,i)},t.prototype.bind=function(e,t){void 0===t&&(t=0);var r=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]=this.unknownTexture},t.prototype.unbind=function(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(t.activeTexture(t.TEXTURE0+i),this.currentLocation=i),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)},t.prototype.initTexture=function(e){var t=new st(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},t.prototype.initTextureType=function(e,t){if(t.internalFormat=e.format,t.type=e.type,2===this.webGLVersion){var r=this.renderer.gl;e.type===r.FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA32F),e.type===o.p.HALF_FLOAT&&(t.type=r.HALF_FLOAT),t.type===r.HALF_FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA16F)}},t.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var r=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(r,e,t));else{var n=e.realWidth,o=e.realHeight,h=r.gl;(t.width!==n||t.height!==o||t.dirtyId<0)&&(t.width=n,t.height=o,h.texImage2D(e.target,0,t.internalFormat,n,o,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},t.prototype.destroyTexture=function(e,t){var r=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var i=this.managedTextures.indexOf(e);-1!==i&&Object(h.w)(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==o.j.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=o.q.CLAMP,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},t.prototype.setStyle=function(e,t){var r=this.gl;if(t.mipmap&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===o.n.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===o.n.LINEAR){var h=Math.min(e.anisotropicLevel,r.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,h)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===o.n.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===o.n.LINEAR?r.LINEAR:r.NEAREST)},t}(M),ut=new c.d,ht=function(e){function t(r){var n=e.call(this,o.m.WEBGL,r)||this;return r=n.options,n.gl=null,n.CONTEXT_UID=0,n.runners={destroy:new l.a("destroy"),contextChange:new l.a("contextChange"),reset:new l.a("reset"),update:new l.a("update"),postrender:new l.a("postrender"),prerender:new l.a("prerender"),resize:new l.a("resize")},n.globalUniforms=new te({projectionMatrix:new c.d},!0),n.addSystem(ze,"mask").addSystem(ae,"context").addSystem(nt,"state").addSystem(it,"shader").addSystem(at,"texture").addSystem(fe,"geometry").addSystem(le,"framebuffer").addSystem(We,"scissor").addSystem(Ye,"stencil").addSystem(Ke,"projection").addSystem(ot,"textureGC").addSystem(ie,"filter").addSystem(Je,"renderTexture").addSystem(oe,"batch"),n.initPlugins(t.__plugins),r.context?n.context.initFromContext(r.context):n.context.initFromOptions({alpha:!!n.transparent,antialias:r.antialias,premultipliedAlpha:n.transparent&&"notMultiplied"!==n.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:n.options.powerPreference}),n.renderingToScreen=!0,Object(h.x)(2===n.context.webGLVersion?"WebGL 2":"WebGL 1"),n.resize(n.options.width,n.options.height),n}return y(t,e),t.create=function(e){if(Object(h.p)())return new t(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.addSystem=function(e,t){t||(t=e.name);var r=new e(this);if(this[t])throw new Error('Whoops! The name "'+t+'" is already in use');for(var i in this[t]=r,this.runners)this.runners[i].add(r);return this},t.prototype.render=function(e,t,r,n,o){if(this.renderingToScreen=!t,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=n,!this.context.isLost){if(t||(this._lastObjectRendered=e),!o){var h=e.enableTempParent();e.updateTransform(),e.disableTempParent(h)}this.renderTexture.bind(t),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),t&&t.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},t.registerPlugin=function(e,r){t.__plugins=t.__plugins||{},t.__plugins[e]=r},t}(function(e){function t(t,r){void 0===t&&(t=o.m.UNKNOWN);var l=e.call(this)||this;return(r=Object.assign({},n.b.RENDER_OPTIONS,r)).roundPixels&&(n.b.ROUND_PIXELS=r.roundPixels,Object(h.h)("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),l.options=r,l.type=t,l.screen=new c.j(0,0,r.width,r.height),l.view=r.view||document.createElement("canvas"),l.resolution=r.resolution||n.b.RESOLUTION,l.transparent=r.transparent,l.autoDensity=r.autoDensity||r.autoResize||!1,l.preserveDrawingBuffer=r.preserveDrawingBuffer,l.clearBeforeRender=r.clearBeforeRender,l._backgroundColor=0,l._backgroundColorRgba=[0,0,0,0],l._backgroundColorString="#000000",l.backgroundColor=r.backgroundColor||l._backgroundColor,l._lastObjectRendered=null,l.plugins={},l}return y(t,e),t.prototype.initPlugins=function(e){for(var t in e)this.plugins[t]=new e[t](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px"),this.emit("resize",e,t)},t.prototype.generateTexture=function(e,t,r,n){0===(n=n||e.getLocalBounds(null,!0)).width&&(n.width=1),0===n.height&&(n.height=1);var o=j.create({width:0|n.width,height:0|n.height,scaleMode:t,resolution:r});return ut.tx=-n.x,ut.ty=-n.y,this.render(e,o,!1,ut,!!e.parent),o},t.prototype.destroy=function(e){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=o.m.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=Object(h.m)(e),Object(h.l)(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),t}(h.c));function lt(e){return ht.create(e)}var ct="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",ft="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",pt=function(){this.texArray=null,this.blend=0,this.type=o.e.TRIANGLES,this.start=0,this.size=0,this.data=null},mt=function(){function e(){this.elements=[],this.ids=[],this.count=0}return e.prototype.clear=function(){for(var i=0;i<this.count;i++)this.elements[i]=null;this.count=0},e}(),vt=function(){function e(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(e.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),e.prototype.view=function(e){return this[e+"View"]},e.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},e.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},e}(),gt=function(e){function t(t){var r=e.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=ke.for2d(),r.size=4*n.b.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return y(t,e),t.prototype.contextChange=function(){var e=this.renderer.gl;n.b.PREFER_ENV===o.f.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),n.b.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var n=Me.replace(/%forloop%/gi,Ne(e));if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,r=t._textureArrayPool,n=this.size/4,o=Math.floor(n/this.MAX_TEXTURES)+1;e.length<n;)e.push(new pt);for(;r.length<o;)r.push(new mt);for(var i=0;i<this.MAX_TEXTURES;i++)this._tempBoundTextures[i]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(element){element._texture.valid&&(this._vertexCount+element.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=element.vertexData.length/2,this._indexCount+=element.indices.length,this._bufferedTextures[this._bufferSize]=element._texture.baseTexture,this._bufferedElements[this._bufferSize++]=element)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,n=t._textureArrayPool,o=this.renderer.batch,h=this._tempBoundTextures,l=this.renderer.textureGC.count,d=++E._globalBatch,c=0,f=n[0],m=0;o.copyBoundTextures(h,r);for(var i=0;i<this._bufferSize;++i){var v=e[i];e[i]=null,v._batchEnabled!==d&&(f.count>=r&&(o.boundArray(f,h,d,r),this.buildDrawCalls(f,m,i),m=i,f=n[++c],++d),v._batchEnabled=d,v.touched=l,f.elements[f.count++]=v)}f.count>0&&(o.boundArray(f,h,d,r),this.buildDrawCalls(f,m,this._bufferSize),++c,++d);for(i=0;i<h.length;i++)h[i]=null;E._globalBatch=d},t.prototype.buildDrawCalls=function(e,r,n){var o=this,l=o._bufferedElements,d=o._attributeBuffer,c=o._indexBuffer,f=o.vertexSize,m=t._drawCallPool,v=this._dcIndex,y=this._aIndex,_=this._iIndex,x=m[v];x.start=this._iIndex,x.texArray=e;for(var i=r;i<n;++i){var T=l[i],E=T._texture.baseTexture,w=h.s[E.alphaMode?1:0][T.blendMode];l[i]=null,r<i&&x.blend!==w&&(x.size=_-x.start,r=i,(x=m[++v]).texArray=e,x.start=_),this.packInterleavedGeometry(T,d,c,y,_),y+=T.vertexData.length/2*f,_+=T.indices.length,x.blend=w}r<n&&(x.size=_-x.start,++v),this._dcIndex=v,this._aIndex=y,this._iIndex=_},t.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this,t=e._packedGeometries,r=e._attributeBuffer,o=e._indexBuffer;n.b.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(o),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(o),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,n=r.gl,o=r.state,h=t._drawCallPool,l=null,i=0;i<e;i++){var d=h[i],c=d.texArray,f=d.type,m=d.size,v=d.start,y=d.blend;l!==c&&(l=c,this.bindAndClearTexArray(c)),this.state.blendMode=y,o.set(this.state),n.drawElements(f,m,n.UNSIGNED_SHORT,2*v)}},t.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),n.b.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var t=Object(h.r)(Math.ceil(e/8)),r=Object(h.q)(t),n=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var o=this._aBuffers[n];return o||(this._aBuffers[n]=o=new vt(n*this.vertexSize*4)),o},t.prototype.getIndexBuffer=function(e){var t=Object(h.r)(Math.ceil(e/12)),r=Object(h.q)(t),n=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var o=this._iBuffers[r];return o||(this._iBuffers[r]=o=new Uint16Array(n)),o},t.prototype.packInterleavedGeometry=function(element,e,t,r,n){for(var o=e.uint32View,l=e.float32View,d=r/this.vertexSize,c=element.uvs,f=element.indices,m=element.vertexData,v=element._texture.baseTexture._batchLocation,y=Math.min(element.worldAlpha,1),_=y<1&&element._texture.baseTexture.alphaMode?Object(h.u)(element._tintRGB,y):element._tintRGB+(255*y<<24),i=0;i<m.length;i+=2)l[r++]=m[i],l[r++]=m[i+1],l[r++]=c[i],l[r++]=c[i+1],o[r++]=_,l[r++]=v;for(i=0;i<f.length;i++)t[n++]=d+f[i]},t._drawCallPool=[],t._textureArrayPool=[],t}(ne),yt=function(){function e(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return e.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),i=0;i<e;i++)t[i]=i;this.defaultGroupCache[e]=te.from({uSamplers:t},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new De(this.vertexSrc,r)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new c.d,default:this.defaultGroupCache[e]};return new Be(this.programCache[e],n)},e.prototype.generateSampleSrc=function(e){var t="";t+="\n",t+="\n";for(var i=0;i<e;i++)i>0&&(t+="\nelse "),i<e-1&&(t+="if(vTextureId < "+i+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n"},e}(),_t=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this)||this;return r._buffer=new H(null,t,!1),r._indexBuffer=new H(null,t,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,o.p.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,o.p.FLOAT).addAttribute("aColor",r._buffer,4,!0,o.p.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,o.p.FLOAT).addIndex(r._indexBuffer),r}return y(t,e),t}($),bt="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",xt="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Tt=function(){function e(){}return e.create=function(e){var t=Object.assign({vertex:bt,fragment:xt,geometryClass:_t,vertexSize:6},e),r=t.vertex,n=t.fragment,o=t.vertexSize,h=t.geometryClass;return function(e){function t(t){var l=e.call(this,t)||this;return l.shaderGenerator=new yt(r,n),l.geometryClass=h,l.vertexSize=o,l}return y(t,e),t}(gt)},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return bt},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentTemplate",{get:function(){return xt},enumerable:!1,configurable:!0}),e}().create()}}]);