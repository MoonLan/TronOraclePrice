(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{1513:function(e,t,n){n(1514),n(1515)},1514:function(e,t,n){var r=n(87),o=n(182),l=n(155),h=r.extend({type:"series.heatmap",getInitialData:function(option,e){return o(this.getSource(),this,{generateCoord:"value"})},preventIncremental:function(){var e=l.get(this.get("coordinateSystem"));if(e&&e.dimensions)return"lng"===e.dimensions[0]&&"lat"===e.dimensions[1]},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}});e.exports=h},1515:function(e,t,n){n(49).__DEV__;var r=n(12),o=n(16),l=n(1516),h=n(1);var c=r.extendChartView({type:"heatmap",render:function(e,t,n){var r;t.eachComponent("visualMap",(function(t){t.eachTargetSeries((function(n){n===e&&(r=t)}))})),this.group.removeAll(),this._incrementalDisplayable=null;var o=e.coordinateSystem;"cartesian2d"===o.type||"calendar"===o.type?this._renderOnCartesianAndCalendar(e,n,0,e.getData().count()):function(e){var t=e.dimensions;return"lng"===t[0]&&"lat"===t[1]}(o)&&this._renderOnGeo(o,e,r,n)},incrementalPrepareRender:function(e,t,n){this.group.removeAll()},incrementalRender:function(e,t,n,r){t.coordinateSystem&&this._renderOnCartesianAndCalendar(t,r,e.start,e.end,!0)},_renderOnCartesianAndCalendar:function(e,t,n,r,l){var c,d,m=e.coordinateSystem;if("cartesian2d"===m.type){var v=m.getAxis("x"),f=m.getAxis("y");c=v.getBandWidth(),d=f.getBandWidth()}for(var y=this.group,data=e.getData(),S="itemStyle",x="emphasis.itemStyle",w="label",M="emphasis.label",style=e.getModel(S).getItemStyle(["color"]),O=e.getModel(x).getItemStyle(),I=e.getModel(w),_=e.getModel(M),C=m.type,z="cartesian2d"===C?[data.mapDimension("x"),data.mapDimension("y"),data.mapDimension("value")]:[data.mapDimension("time"),data.mapDimension("value")],D=n;D<r;D++){var rect;if("cartesian2d"===C){if(isNaN(data.get(z[2],D)))continue;var R=m.dataToPoint([data.get(z[0],D),data.get(z[1],D)]);rect=new o.Rect({shape:{x:Math.floor(Math.round(R[0])-c/2),y:Math.floor(Math.round(R[1])-d/2),width:Math.ceil(c),height:Math.ceil(d)},style:{fill:data.getItemVisual(D,"color"),opacity:data.getItemVisual(D,"opacity")}})}else{if(isNaN(data.get(z[1],D)))continue;rect=new o.Rect({z2:1,shape:m.dataToRect([data.get(z[0],D)]).contentShape,style:{fill:data.getItemVisual(D,"color"),opacity:data.getItemVisual(D,"opacity")}})}var A=data.getItemModel(D);data.hasItemOption&&(style=A.getModel(S).getItemStyle(["color"]),O=A.getModel(x).getItemStyle(),I=A.getModel(w),_=A.getModel(M));var V=e.getRawValue(D),P="-";V&&null!=V[2]&&(P=V[2]),o.setLabelStyle(style,O,I,_,{labelFetcher:e,labelDataIndex:D,defaultText:P,isRectText:!0}),rect.setStyle(style),o.setHoverStyle(rect,data.hasItemOption?O:h.extend({},O)),rect.incremental=l,l&&(rect.useHoverLayer=!0),y.add(rect),data.setItemGraphicEl(D,rect)}},_renderOnGeo:function(e,t,n,r){var c=n.targetVisuals.inRange,d=n.targetVisuals.outOfRange,data=t.getData(),m=this._hmLayer||this._hmLayer||new l;m.blurSize=t.get("blurSize"),m.pointSize=t.get("pointSize"),m.minOpacity=t.get("minOpacity"),m.maxOpacity=t.get("maxOpacity");var rect=e.getViewRect().clone(),v=e.getRoamTransform();rect.applyTransform(v);var f=Math.max(rect.x,0),y=Math.max(rect.y,0),S=Math.min(rect.width+rect.x,r.getWidth()),x=Math.min(rect.height+rect.y,r.getHeight()),w=S-f,M=x-y,O=[data.mapDimension("lng"),data.mapDimension("lat"),data.mapDimension("value")],I=data.mapArray(O,(function(t,n,r){var o=e.dataToPoint([t,n]);return o[0]-=f,o[1]-=y,o.push(r),o})),_=n.getExtent(),C="visualMap.continuous"===n.type?function(e,t){var n=e[1]-e[0];return t=[(t[0]-e[0])/n,(t[1]-e[0])/n],function(e){return e>=t[0]&&e<=t[1]}}(_,n.option.range):function(e,t,n){var r=e[1]-e[0],o=(t=h.map(t,(function(t){return{interval:[(t.interval[0]-e[0])/r,(t.interval[1]-e[0])/r]}}))).length,l=0;return function(e){for(var i=l;i<o;i++)if((r=t[i].interval)[0]<=e&&e<=r[1]){l=i;break}if(i===o)for(i=l-1;i>=0;i--){var r;if((r=t[i].interval)[0]<=e&&e<=r[1]){l=i;break}}return i>=0&&i<o&&n[i]}}(_,n.getPieceList(),n.option.selected);m.update(I,w,M,c.color.getNormalizer(),{inRange:c.color.getColorMapper(),outOfRange:d.color.getColorMapper()},C);var img=new o.Image({style:{width:w,height:M,x:f,y:y,image:m.canvas},silent:!0});this.group.add(img)},dispose:function(){}});e.exports=c},1516:function(e,t,n){var r=n(1);function o(){var canvas=r.createCanvas();this.canvas=canvas,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={}}o.prototype={update:function(data,e,t,n,r,o){var l=this._getBrush(),h=this._getGradient(data,r,"inRange"),c=this._getGradient(data,r,"outOfRange"),d=this.pointSize+this.blurSize,canvas=this.canvas,m=canvas.getContext("2d"),v=data.length;canvas.width=e,canvas.height=t;for(var i=0;i<v;++i){var p=data[i],f=p[0],y=p[1],S=n(p[2]);m.globalAlpha=S,m.drawImage(l,f-d,y-d)}if(!canvas.width||!canvas.height)return canvas;for(var x=m.getImageData(0,0,canvas.width,canvas.height),w=x.data,M=0,O=w.length,I=this.minOpacity,_=this.maxOpacity-I;M<O;){S=w[M+3]/256;var C=4*Math.floor(255*S);if(S>0){var z=o(S)?h:c;S>0&&(S=S*_+I),w[M++]=z[C],w[M++]=z[C+1],w[M++]=z[C+2],w[M++]=z[C+3]*S*256}else M+=4}return m.putImageData(x,0,0),canvas},_getBrush:function(){var e=this._brushCanvas||(this._brushCanvas=r.createCanvas()),t=this.pointSize+this.blurSize,n=2*t;e.width=n,e.height=n;var o=e.getContext("2d");return o.clearRect(0,0,n,n),o.shadowOffsetX=n,o.shadowBlur=this.blurSize,o.shadowColor="#000",o.beginPath(),o.arc(-t,t,this.pointSize,0,2*Math.PI,!0),o.closePath(),o.fill(),e},_getGradient:function(data,e,t){for(var n=this._gradientPixels,r=n[t]||(n[t]=new Uint8ClampedArray(1024)),o=[0,0,0,0],l=0,i=0;i<256;i++)e[t](i/255,!0,o),r[l++]=o[0],r[l++]=o[1],r[l++]=o[2],r[l++]=o[3];return r}};var l=o;e.exports=l}}]);